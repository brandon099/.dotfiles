#!/bin/env fish

# Output format
function info --description 'Info logging wrapper'
    echo -e "\e[34m:: $argv\e[0m"
end
function warning
    echo -e "\e[33m:: $argv\e[0m"
end
function error
    echo -e "\e[31m:: $argv\e[0m"
end

# Cannot run as root user
test (id -u) -gt 0; or error "This script cannot be run as root."

# Update Cached sudo credentials
info "Updating cached sudo credentials"
sudo -v

# Check for trizen to begin installing pkgs, else try installing it
if command -v trizen
    info "Installing from pkgs file"
    trizen -S (cat ~/.dotfiles/scripts/pkgs | sed 's/\\n/\n/g') --needed --devel --noconfirm --noedit
else
    warning "Trizen not installed, trying to install..."
    sh ~/.dotfiles/scripts/install-trizen
end

info "Finished installing packages"
