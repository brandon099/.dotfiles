#! /bin/sh

source ~/.config/global.conf

bspc config top_padding             20
bspc config left_padding            0
bspc config right_padding           0
bspc config bottom_padding          0
bspc config border_width            1
bspc config window_gap              5
bspc config split_ratio             0.5
bspc config borderless_monocle      true
bspc config gapless_monocle         true
bspc config focus_follows_pointer   true
bspc config pointer_follows_monitor false
bspc config pointer_follows_focus   false
bspc config focus_by_distance       true
bspc config focused_border_color    $BLUE
bspc config unfocused_border_color  $GREY

desktops=$(bspc query --monitors)

if [[ $(echo "$desktops" | wc -l) -eq 3 ]]; then
    bspc monitor ^1 -s ^3
    bspc monitor ^1 -s ^2
fi

echo "$desktops" | grep -q "[a-zA-Z]"
if [ $? -eq 0 ]; then IsInitialRun=true; else IsInitialRun=false; fi

# Create desktops or reset desktop configuration if it already exists.
i=1
for monitor in $desktops; do
    [ "$IsInitialRun" = true ] && \
        bspc monitor "$monitor" -n $i -d $i/{i,ii,iii,iiii,iiiii} || \
        bspc monitor "$monitor" -d $i/{i,ii,iii,iiii,iiiii}
    let i++
done

killall panel
exec ~/.scripts/panel
